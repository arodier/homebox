---

- name: Push the web site if it already exists
  ansible.builtin.include_tasks: install/backup-push.yml

- name: Create default web site
  ansible.builtin.include_tasks: install/default-content.yml

- name: Create the DNS record
  ansible.builtin.include_tasks: install/dns.yml

- name: Copy the certificate
  ansible.builtin.include_tasks: install/certificates.yml

- name: Configure nginx
  ansible.builtin.include_tasks: install/nginx.yml
  tags: nginx

- name: Configure apparmor
  ansible.builtin.include_tasks: install/apparmor.yml

- name: Pull the web site content
  ansible.builtin.include_tasks: install/backup-pull.yml
