---

- name: Chheck if the DNS server is resolving correctly
  register: host_main
  getent:
    database: hosts
    key: main.{{ network.domain }}
  tags: dns
  ignore_errors: true

- name: Store the fact when the DNS server is live
  when: host_main is not failed
  set_fact:
    dns_is_live: true
  tags: dns

- name: Store the fact when the DNS server is not live
  when: host_main is failed
  set_fact:
    dns_is_live: false
  tags: dns
