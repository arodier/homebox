---

- name: Create logging directory
  file:
    path: /var/log/nftables
    state: directory
    mode: 0700

- name: Deploy the system log configuration
  notify: Restart rsyslog
  template:
    src: logging/rsyslog.conf
    dest: /etc/rsyslog.d/nftables.conf

- name: Deploy the logrotate configutation
  template:
    src: logging/logrotate.conf
    dest: /etc/logrotate.d/nftables

- name: Create empty configuration files for tail/lnav
  file:
    path: '{{ path }}'
    state: touch
  loop:
    - /var/log/nftables/in.log
    - /var/log/nftables/out.log
    - /var/log/nftables/fwd.log
  loop_control:
    loop_var: path
