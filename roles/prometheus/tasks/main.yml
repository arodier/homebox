---

- name: Install the required packages
  include_tasks: packages.yml
  tags: apt

- name: Install the notification templates
  tags: templates
  include_tasks: templates.yml

- name: Configure system alerts
  include_tasks: system-disk-alerts.yml
  tags: config

- name: Install the server configuration
  include_tasks: config-server.yml
  tags: config

- name: Install the exporter configuration
  include_tasks: config-exporter.yml
  tags: config

- name: Install the blackbox exporter
  include_tasks: blackbox-exporter.yml
  tags: blackbox

- name: Set the alert manager
  include_tasks: config-alert-manager.yml
  tags: config

- name: Deploy system disk alerts
  include_tasks: system-disk-alerts.yml
  tags: system

- name: Deploy system memory alerts
  include_tasks: system-memory-alerts.yml
  tags: system

- name: Deploy system load alerts
  include_tasks: system-load-alerts.yml
  tags: system

- name: Set the XMPP alerts
  when: ejabberd.install
  include_tasks: config-xmpp.yml
  tags: xmpp

- name: Copy the certificates
  include_tasks: certificates.yml
  tags: certs

- name: Configure nginx
  include_tasks: nginx.yml
  tags: nginx
