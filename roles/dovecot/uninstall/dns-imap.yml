---

- name: Delete the main IMAP record
  shell: >-
    pdnsutil delete-rrset {{ network.domain }}
    imap {{ external_ip_type }}
  changed_when: true

- name: Delete the backup IMAP record
  when: backup_ip is defined
  shell: >-
    pdnsutil delete-rrset {{ network.domain }}
    imap {{ backup_ip_type }}
  changed_when: true

- name: Delete the IMAP SRV record to prevent IMAP access
  shell: >-
    pdnsutil delete-rrset {{ network.domain }}
    _imap._tcp SRV
  changed_when: true

- name: Delete the IMAPS SRV record
  shell: >-
    pdnsutil delete-rrset {{ network.domain }}
    _imaps._tcp SRV
  changed_when: true
