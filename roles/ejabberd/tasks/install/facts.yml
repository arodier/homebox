---

- name: Load or create the password for the read-only account
  no_log: '{{ not system.devel }}'
  ansible.builtin.set_fact:
    ldap_ro_password: '{{ lookup(creds.store, network.domain + "/ldap/readonly") }}'

- name: Compute the users DN
  ansible.builtin.set_fact:
    ldap_users_dn: 'ou=users,dc={{ network.domain.split(".") | join(",dc=") }}'

- name: Set the readonly userâ€™ DN
  ansible.builtin.set_fact:
    ldap_readonly_dn: 'cn=readonly account,{{ ldap_users_dn }}'
