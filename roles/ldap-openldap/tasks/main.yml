---

- name: Initialise or load the passwords
  include_tasks: load-passwords.yml

- name: Create the DNS record
  include_tasks: dns.yml
  tags: dns

- name: Preconfigure and install the packages
  include_tasks: packages.yml

- name: Configure the basic encryption
  include_tasks: ssl-base.yml
  tags: certs

- name: Configure the deref module
  include_tasks: module-deref.yml

- name: Configure the password policies
  include_tasks: module-ppolicies.yml

- name: Load misc schema
  include_tasks: schema-misc.yml

- name: Load internatioanl email address schema
  include_tasks: schema-intmail.yml

- name: Configure the LDAP server settings
  include_tasks: db-accounts.yml

- name: Create the special accounts
  include_tasks: special-accounts.yml

- name: Set access policies
  include_tasks: access-policies.yml

- name: Add prometheus alerts
  when: prometheus.install
  tags: prometheus
  include_tasks: prometheus.yml

- name: Post accounts creation configuration
  include_tasks: post-install.yml
