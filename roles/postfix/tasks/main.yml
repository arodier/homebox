---

- name: Pre-installation tasks
  include_tasks: preinstall.yml

- name: Install the packages
  include_tasks: packages.yml

- name: Set the initial facts
  include_tasks: facts.yml
  tags: facts

- name: Copy the certificates
  include_tasks: certificates.yml
  tags: certs

- name: Generic config
  include_tasks: config.yml

- name: Firewall configuration
  include_tasks: firewall.yml

- name: AppArmor configuration
  include_tasks: apparmor.yml

- name: Logging configuration
  include_tasks: rsyslog.yml
  tags: syslog

- name: Add Prometheus alerts
  when: prometheus.install
  tags: prometheus
  include_tasks: prometheus.yml

- name: DNS configuration
  include_tasks: dns.yml
  tags: dns
