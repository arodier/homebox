---

- name: Install prometheus postfix exporter
  tags: prometheus
  ansible.builtin.apt:
    name: prometheus-postfix-exporter
    state: present

- name: Deploy target configuration
  tags: prometheus
  ansible.builtin.template:
    src: prometheus/target.yml
    dest: /etc/prometheus/targets/postfix.yml
    mode: '0644'

- name: Deploy prometheus alerts
  tags: prometheus
  ansible.builtin.template:
    src: prometheus/alerts.yml
    dest: /etc/prometheus/alerts/postfix-rules.yml
    mode: '0644'
