---

## Main installation playbook

- name: Install Homebox (Micro version)
  hosts: homebox
  vars_files:
    - '{{ playbook_dir }}/../config/system.yml'
    - '{{ playbook_dir }}/../config/defaults.yml'
  roles:
    - role: load-defaults
      tags: always
    - role: external-ip-type
      tags: always
    - role: bootstrap
      tags: always
    - role: cloud-vultr-setup
      tags: cloud
    - role: firewall
      tags: firewall
    - role: dns-pdns
      tags: dns
    - role: dns-publish
      tags: dns
    - role: ldap-openldap
      tags: ldap
    - role: home-users-storage
      tags: storage
    - role: home-archives-storage
      tags: storage
    - role: user-setup
      tags: user
    - role: nginx
      tags: nginx
    - role: dovecot
      tags: dovecot
    - role: postfix
      tags: postfix
    - role: opendkim
      tags: dkim
    - role: opendmarc
      tags: dmarc
    - role: mta-sts
      tags: mta-sts
    - role: website-simple
      tags: website
    - role: autoconfig
      tags: autoconfig
    - role: post-install
      tags: post-install
